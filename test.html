<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Required meta tags always come first -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta http-equiv="x-ua-compatible" content="ie=edge">

		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi" crossorigin="anonymous">
	</head>
	<body>
		<h1>Hello, world!</h1>

		<table id="personDataTable" class="table table-hover">
			<thead>
				<tr>
					<th>#</th>
					<th>Juragan</th>
					<th>Tanggal</th>
					<th>Pemesan</th>
					<th width="15%">Pesanan</th>
					<th>Biaya</th>
					<th>Keterangan</th>
					<th>Resi Kirim</th>
				</tr>
			</thead>
		</table>
				

		<!-- jQuery first, then Tether, then Bootstrap JS. -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/js/bootstrap.min.js" integrity="sha384-BLiI7JTZm+JWlgKa0M0kGRpJbF2J8q+qreVrKBC47e3K6BW78kGLrCkeRX6I9RoK" crossorigin="anonymous"></script>

		<script type="text/javascript">
			
			$.ajax({
				url: 'http://localhost/order-juragan/index.php/json/pesanan',
				type: 'GET',
				dataType: "json",
				data: {
					'halaman': '2',
					'cari': ''
				},
				success: function(data, textStatus, jqXHR) {
					// since we are using jQuery, you don't need to parse response
					// drawTable(data);
					drawTable(data.row);
				}
			});

			function drawTable(data) {
				$.each(data, function (index, orderan) {

					// hp
					var hp_array = '';
			        $.each(orderan.pemesan.hp, function (i, hape) {  
			        	var htmlhp = '';
			        	if(i > 0) {
			        		htmlhp += '<span class="sr-only">/</span>';
			        	}
			        	htmlhp += '<span class="tag tag-info">' + hape + '</span>';
			        	hp_array += htmlhp ;
			        });

			        // pesanan
			        var pesanan_array = '';
			        var c_pesan =  0;
			        $.each(orderan.pesanan.produk, function (i, pesan) {  
			        	var html_p = '';
			        	c_pesan = c_pesan +  parseInt(pesan.jumlah);
			        	html_p += '<div>' + pesan.kode + ' (' + pesan.size + ') = '+pesan.jumlah + ' pcs</div>';
			        	
			        	pesanan_array += html_p;
			        });
			              

			        $("#personDataTable")
			        	.append(
			        		$('<tr></tr>').html("<td><a href='?id="+orderan.uid+"'>"+orderan.id+"</a></td>")
			        		.append('<td>' + orderan.juragan.nama + '</td>')
			        		.append('<td>' + orderan.tanggal.submit + '</td>')
			        		.append('<td>' + orderan.pemesan.nama + '<div class="hp">' + hp_array + '</div>' +orderan.pemesan.alamat+ '</td>')
			                .append('<td>' + pesanan_array +'<hr/><em>total : </em><span class="tag tag-default tag-pill">'+c_pesan+'</span> pcs</td>')
			                .append('<td>' + orderan.biaya.harga + '<br/>' + orderan.biaya.ongkir + '<br/>' + orderan.biaya.ongkir_fix + '<br/>' + orderan.biaya.transfer1 + '<br/>' + orderan.biaya.transfer2 + '</td>')
			            );    
			    }); 


			}




		</script>
	</body>
</html>